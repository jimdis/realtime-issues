!function(e){var t={};function s(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(o,a,function(t){return e[t]}.bind(null,a));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);const o="/api/";async function a(e){console.log("Getting Data from: "+e);let t=await window.fetch(o+e);return t=await t.json(),console.log("Returning Data",t),t}const r="https://65fc704f.ngrok.io/api";async function n(e){if(e.hookID){await async function(e,t){return 204===(await window.fetch(`api/repo/?wh=true&path=${e}&action=delete&id=${t}`)).status}(e.full_name,e.hookID)?(e.hookID=null,i("off"),M.toast({html:'<span class="green-text">Alert removed!</span>'})):M.toast({html:'<span class="red-text">There was a problem removing the alert</span>'})}else{let t=await async function(e){let t=await window.fetch(`api/repo/?wh=true&path=${e}&action=create`);if((t=await t.json()).active)return t}(e.full_name);t?(e.hookID=t.id,i("on"),M.toast({html:'<span class="green-text">Alert created!</span>'})):M.toast({html:'<span class="red-text">There was a problem creating the alert</span>'})}}function i(e){"on"===e&&($("#issues-wrapper .notificationIcon").removeClass("red"),$("#issues-wrapper .notificationIcon").addClass("green"),$("#issues-wrapper .notificationIcon").attr("data-badge-caption","on"),$("#issues-wrapper .notificationIcon").attr("data-tooltip","Remove issue notifications for this repo")),"off"===e&&($("#issues-wrapper .notificationIcon ").removeClass("green"),$("#issues-wrapper .notificationIcon ").addClass("red"),$("#issues-wrapper .notificationIcon ").attr("data-badge-caption","off"),$("#issues-wrapper .notificationIcon").attr("data-tooltip","Remove issue notifications for this repo"))}let l=new class{async getUserData(){let e=await a("user");this.avatar=e.avatar_url,this.name=e.name}async getRepos(){let e=await a("user/repos");this.repos=[],e.forEach(e=>{if(e.open_issues_count>0){let t={};t.id=e.id,t.full_name=e.full_name,t.description=e.description,this.repos.push(t)}})}async getIssues(e){let t=await a(`repos/${e.full_name}/issues`),s=[];t.forEach(e=>{let t={};t.id=e.id,t.title=e.title,t.username=e.user.login,t.avatar=e.user.avatar_url,t.body=e.body,t.url=e.html_url,t.comments=e.comments,s.push(t)}),e.issues=s}};async function u(){$(".fixed-action-btn").removeClass("hide"),$(".tooltipped").tooltip(),$("#issuesDiv").append($("#reposTemplate").html()),await l.getUserData(),$("#issues-wrapper").removeClass("hide"),$("#reposHeader").addClass("rendered"),$("#user-preloader").remove(),$("#issuesDiv .collection").removeClass("hide"),$("#issuesDiv img.gh-avatar").attr("src",l.avatar),$("#gh-name-repos").text(`${l.name}'s Repos with open issues`),await l.getRepos(),$("#repo-preloader").remove(),l.repos.forEach(e=>{let t=document.querySelector("#repoListTemplate").content.cloneNode(!0);t.querySelector(".repo-title").textContent=`Repo: ${e.full_name}`,t.querySelector(".repo-description").textContent=e.description,t.querySelector("a").setAttribute("data-issues",e.id),$("#issuesDiv div.collection").append(t),async function(e){let t=(await a(`repos/${e.full_name}/hooks`)).find(e=>e.config.url===r);t&&(e.hookID=t.id,document.querySelector(`#issues-${e.id}`)&&i("on"))}(e)}),$("#issuesDiv div.collection a").click(e=>{e.preventDefault(),$("a.collection-item").removeClass("active"),$(e.currentTarget).addClass("active"),c($(e.currentTarget).data("issues"))})}async function c(e){let t=l.repos.find(t=>t.id===e);$("#issues-wrapper .issuesCollection").remove(),$("#reposHeader").after($("#issuesTemplate").html()),$("#issues-wrapper .issuesCollection").attr("id",`issues-${t.id}`),$("#issues-wrapper .issuesCollection .title").text(`Issues in ${t.full_name}`),t.hookID&&i("on"),t.issues||await l.getIssues(t),$("#issues-preloader").remove(),t.issues.forEach(e=>{let t=document.querySelector("#issuesListTemplate").content.cloneNode(!0);t.querySelector(".title").textContent=e.title,t.querySelector(".gh-avatar").src=e.avatar,t.querySelector(".gh-avatar").title=e.username,t.querySelector(".body").textContent=e.body?e.body:"No description provided :(",t.querySelector("a").href=e.url,t.querySelector(".badge").textContent=e.comments,$("#issues-wrapper .issuesCollection ul").append(t)}),$("#issues-wrapper .tooltipped").tooltip(),$("#issues-wrapper .notificationIcon").click(e=>{e.preventDefault(),n(t)}),$("#issues-wrapper .issueListClose").click(e=>{e.preventDefault(),$("a.collection-item").removeClass("active"),$("#issues-wrapper .issuesCollection").remove()})}async function p(){let e=await window.fetch("auth/session");(e=await e.json()).active?async function(){let e=await window.fetch("auth/status");e=await e.json(),$("#main-preloader").remove(),e.authorized?(l.username=e.username,$("#index-banner .badge span").text(l.username),$("#index-banner .badge").removeClass("hide"),$("#index-banner").addClass("logged-in"),u()):($("#index-banner .row").removeClass("hide"),$("#errorMessage").removeClass("hide"),$("#mainButton").text("Authorize again through GitHubÂ»"))}():($("#index-banner .row, #subTitle").removeClass("hide"),$("#main-preloader").remove())}io().on("issue",async e=>{if(e.issue){!function(e){let t=document.querySelector("#newIssueTemplate").content.cloneNode(!0),s=`card-${Math.random().toString(36).replace("0.","")}`;t.firstElementChild.id=s,t.querySelector(".newIssueTitle").textContent=`${e.comment?"Comment":"Issue"} ${e.action}`,t.querySelector(".gh-avatar").src=e.sender.avatar_url,t.querySelector(".newIssueBody").textContent=`${e.sender.login} just ${e.action} ${e.comment?" a Comment":"an Issue"} in ${e.repository.name}`,t.querySelector(".newIssueGoto").href=e.comment?e.comment.html_url:e.issue.html_url,$("#newIssuesDiv").append(t),$(`#${s} .newIssueDismiss`).click(e=>{e.preventDefault(),$(`#${s}`).remove()})}(e);let t=l.repos.find(t=>t.id===e.repository.id);await l.getIssues(t),document.querySelector(`#issues-${t.id}`)&&c(t.id)}}),$(document).ready(()=>p())}]);